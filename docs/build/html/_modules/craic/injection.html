

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>craic.injection &mdash; craic 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            craic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../subpages/project.html">Project &amp; Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subpages/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subpages/modules.html">Modules &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subpages/tutorial.html">Quickstart Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subpages/versions.html">Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">craic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">craic.injection</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for craic.injection</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.constants</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">c</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.particles</span><span class="w"> </span><span class="kn">import</span> <span class="n">particles</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.transport</span><span class="w"> </span><span class="kn">import</span> <span class="n">transport</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.accelerator</span><span class="w"> </span><span class="kn">import</span> <span class="n">accelerator</span>
<span class="n">part</span> <span class="o">=</span> <span class="n">particles</span><span class="p">()</span>
<span class="n">tran</span> <span class="o">=</span> <span class="n">transport</span><span class="p">()</span>
<span class="n">acel</span> <span class="o">=</span> <span class="n">accelerator</span><span class="p">()</span>

<div class="viewcode-block" id="compute_pflux_impulsive_extended">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_pflux_impulsive_extended">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">R_esc</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">N_0</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">Ep</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">yr</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_pflux_impulsive_extended</span><span class="p">(</span><span class="n">Resc</span><span class="p">,</span>
        <span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute differential proton flux density (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) for an </span>
<span class="sd">    impulsive injection from the surface of an extended source.</span>
<span class="sd">    The difference to the case of a point source is the normalisation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Resc : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle escape radius (=distance from source center). (pc)</span>
<span class="sd">    N_0 : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Normalisation of particle distribution function normalising the</span>
<span class="sd">        energy injection rate (L_CR, which could be E_totCR/age). (GeV/s)</span>
<span class="sd">    Ep : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle energy. (GeV)</span>
<span class="sd">    d : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Distance to particle injection location. (pc)</span>
<span class="sd">    a : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Time since particle injection at source (can differ from its age). (yr)</span>
<span class="sd">    dens : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Density of traversed ambient matter. (:math:`\mathrm{cm}^{-3}`)</span>
<span class="sd">        Default value for ISM is 1 :math:`\mathrm{cm}^{-3}`.</span>
<span class="sd">    chi : float</span>
<span class="sd">        Scalar suppression factor for diffusion coefficient, relating to</span>
<span class="sd">        the level of turbulence along the particles path.</span>
<span class="sd">        (ism: 1, clouds: 0.05)</span>
<span class="sd">    alpha : float</span>
<span class="sd">        Proton spectrum spectral index. (default: 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sqrt_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">Resc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Resc</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Ep</span><span class="p">))</span>

    <span class="n">Rdiff</span> <span class="o">=</span> <span class="n">tran</span><span class="o">.</span><span class="n">R_diffusion</span><span class="p">(</span><span class="n">Ep</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">)</span>

    <span class="c1"># Normalisation factor (eq. 9 in Mitchell et al. 2020)</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">sqrt_pi</span> <span class="o">*</span> <span class="n">Rdiff</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sqrt_pi</span> <span class="o">*</span> <span class="n">Resc</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt_pi</span> <span class="o">*</span> <span class="n">Rdiff</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">term</span> <span class="o">*</span> <span class="n">Rdiff</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Resc</span> <span class="o">*</span> <span class="n">Rdiff</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">pflux</span> <span class="o">=</span> <span class="n">f0</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span> <span class="o">*</span> \
            <span class="n">compute_pflux_impulsive_point</span><span class="p">(</span><span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">dens</span><span class="p">,</span>
                <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">pflux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span></div>


<div class="viewcode-block" id="compute_pflux_impulsive_point">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_pflux_impulsive_point">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">N_0</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">Ep</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">yr</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_pflux_impulsive_point</span><span class="p">(</span><span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">ism</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute differential proton flux density (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) for an </span>
<span class="sd">    impulsive injection from a point source as given by </span>
<span class="sd">    `Aharonian &amp; Atoyan (1996), A&amp;A 309, 917 &lt;https://ui.adsabs.harvard.edu/abs/1996A%26A...309..917A/abstract&gt;`_ (eq. 3).</span>
<span class="sd">    </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N_0 : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Normalisation of particle distribution function normalising the</span>
<span class="sd">        energy injection rate (L_CR, which could be E_totCR/age). (GeV/s)</span>
<span class="sd">    Ep : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle energy. (GeV)</span>
<span class="sd">    d : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Distance to particle injection location. (pc)</span>
<span class="sd">    a : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Time since particle injection at source (can differ from its age). (yr)</span>
<span class="sd">    dens : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Density of traversed ambient matter. (:math:`\mathrm{cm}^{-3}`)</span>
<span class="sd">        Default value for ISM is 1 :math:`\mathrm{cm}^{-3}`.</span>
<span class="sd">    chi : float</span>
<span class="sd">        Scalar suppression factor for diffusion coefficient, relating to</span>
<span class="sd">        the level of turbulence along the particles path.</span>
<span class="sd">        (ism: 1, clouds: 0.05)</span>
<span class="sd">    alpha : float</span>
<span class="sd">        Proton spectrum spectral index. (default: 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Rdiff</span> <span class="o">=</span> <span class="n">tran</span><span class="o">.</span><span class="n">R_diffusion</span><span class="p">(</span><span class="n">Ep</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>

    <span class="n">exp_frac</span> <span class="o">=</span> <span class="o">-</span><span class="p">(((</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">t_ppEK</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">Ep</span><span class="p">)))</span> \
               <span class="o">-</span> <span class="p">((</span><span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">))</span> <span class="o">/</span> <span class="n">Rdiff</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ep</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)))</span> <span class="o">/</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rdiff</span> <span class="o">**</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">pflux</span> <span class="o">=</span> <span class="n">coeff</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_frac</span><span class="p">)</span>

    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">pflux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span></div>


<span class="c1"># Equals &amp; replaces former flux.flux_calc():</span>
<span class="c1">#     def flux_calc(self, N_0, Ep, d, a, dens, chi=0.05, ism=0):</span>

<div class="viewcode-block" id="compute_pflux_continuous_extended">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_pflux_continuous_extended">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">Resc</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">N_0</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">Ep</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">yr</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_pflux_continuous_extended</span><span class="p">(</span><span class="n">Resc</span><span class="p">,</span>
        <span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute differential proton flux density (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) for an </span>
<span class="sd">    continuous injection from the surface of an extended source.</span>
<span class="sd">    The difference to the case of a point source is the normalisation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Resc : :class:`astropy.Quantity`</span>
<span class="sd">        Particle escape radius (=distance from source center). (pc)</span>
<span class="sd">    N_0 : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Normalisation of particle distribution function normalising the</span>
<span class="sd">        energy injection rate (L_CR, which could be E_totCR/age). (GeV/s)</span>
<span class="sd">    Ep : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle energy. (GeV)</span>
<span class="sd">    d : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Distance to particle injection location. (pc)</span>
<span class="sd">    a : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Time since particle injection at source (can differ from its age). (yr)</span>
<span class="sd">    dens : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Density of traversed ambient matter. (:math:`\mathrm{cm}^{-3}`)</span>
<span class="sd">        Default value for ISM is 1 :math:`\mathrm{cm}^{-3}`.</span>
<span class="sd">    chi : float</span>
<span class="sd">        Scalar suppression factor for diffusion coefficient, relating to</span>
<span class="sd">        the level of turbulence along the particles path.</span>
<span class="sd">        (ism: 1, clouds: 0.05)</span>
<span class="sd">    alpha : float</span>
<span class="sd">        Proton spectrum spectral index. (default: 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">erf</span><span class="p">,</span> <span class="n">erfc</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;f0 for cont. ext. case still to be revised!&quot;</span><span class="p">)</span>
    <span class="c1">####### REVISION REQUIRED!! THIS NORMALISATION IS WRONG!!!</span>
    <span class="c1">#f0 = 2. * tran.Diffusion_Coefficient(Ep, dens, ism=1) * Ep**alpha</span>
    <span class="c1">#rratio = Resc / d</span>
    <span class="c1">#f0 = 4.*np.pi</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="c1">#f0 /= erfc(rratio) * Resc**2. + erf(rratio) * 0.5 * d**(-2.) - np.exp(-rratio**2.) * Resc * d**(-1.) * np.pi**-0.5</span>
    
    <span class="c1">#pflux = f0.decompose() * \</span>
    <span class="n">pflux</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">*</span>  <span class="n">compute_pflux_continuous_point</span><span class="p">(</span><span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">dens</span><span class="p">,</span>
                <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">pflux</span></div>


<span class="c1"># Equals &amp; replaces former flux.flux_calc_cont():</span>
<span class="c1">#     def flux_calc_cont(self, N_0, Ep, d, a, dens, chi=0.05, ism=0):</span>

<div class="viewcode-block" id="compute_pflux_continuous_point">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_pflux_continuous_point">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">N_0</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">Ep</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">yr</span><span class="p">,</span> <span class="n">dens</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_pflux_continuous_point</span><span class="p">(</span><span class="n">N_0</span><span class="p">,</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">ism</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute differential proton flux density (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) for a continuous injection </span>
<span class="sd">    from a point source as given by `Aharonian &amp; Atoyan (1996), A&amp;A 309, 917 &lt;https://ui.adsabs.harvard.edu/abs/1996A%26A...309..917A/abstract&gt;`_ (eq. 8).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N_0 : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Normalisation of particle distribution function normalising the</span>
<span class="sd">        energy injection rate (L_CR, which could be E_totCR/age). (GeV/s)</span>
<span class="sd">    Ep : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle energy. (GeV)</span>
<span class="sd">    d : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Distance to particle injection location. (pc)</span>
<span class="sd">    a : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Time since particle injection at source (can differ from its age). (yr)</span>
<span class="sd">    dens : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Density of traversed ambient matter. (:math:`\mathrm{cm}^{-3}`)</span>
<span class="sd">        Default value for ISM is 1 :math:`\mathrm{cm}^{-3}`.</span>
<span class="sd">    chi : float</span>
<span class="sd">        Scalar suppression factor for diffusion coefficient, relating to</span>
<span class="sd">        the level of turbulence along the particles path.</span>
<span class="sd">        (ism: 1, clouds: 0.05)</span>
<span class="sd">    alpha : float</span>
<span class="sd">        Proton spectrum spectral index. (default: 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">erfc</span>

    <span class="c1"># Q_0 is injection rate, two possible ways:</span>
    <span class="c1"># (A) (normalisation computed for tot E_CR) / (time during which injection took place)</span>
    <span class="n">Q_0</span> <span class="o">=</span> <span class="n">N_0</span> <span class="o">/</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
    <span class="c1"># (B) (normalisation computed for CR lum.)</span>
    <span class="c1"># Q_0 = N_0</span>

    <span class="c1"># Compute proton flux density according to</span>
    <span class="c1"># eq. 8 in Aharonian &amp; Atoyan (1996) and/or eq. 21 in Atoyan (1995)</span>
    <span class="n">rfrac</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span> <span class="o">/</span> <span class="n">tran</span><span class="o">.</span><span class="n">R_diffusion</span><span class="p">(</span><span class="n">Ep</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">Q_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ep</span><span class="o">**-</span><span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">tran</span><span class="o">.</span><span class="n">Diffusion_Coefficient</span><span class="p">(</span><span class="n">Ep</span><span class="p">,</span> <span class="n">dens</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">chi</span><span class="p">,</span> <span class="n">ism</span><span class="o">=</span><span class="n">ism</span><span class="p">))</span>
    <span class="n">pflux</span> <span class="o">=</span> <span class="n">coeff</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">rfrac</span><span class="p">)</span>

    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">pflux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span></div>


<span class="c1"># Define functions for Galactic CRs</span>

<div class="viewcode-block" id="e2R">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.e2R">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">e2R</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GV</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute proton rigidity (``GV``) from particle energy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    e : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Particle energy. (``GeV``)</span>
<span class="sd">    Z : float</span>
<span class="sd">        Charge number, 1 for a proton.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">e</span> <span class="o">/</span> <span class="p">(</span><span class="n">Z</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">si</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span></div>


<div class="viewcode-block" id="compute_fgal">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_fgal">[docs]</a>
<span class="nd">@u</span><span class="o">.</span><span class="n">quantity_input</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_fgal</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns differential proton density of galactic CRs (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) </span>
<span class="sd">    measured by `AMS Collab. (2015), PRL 114 171103 &lt;https://journals.aps.org/prl/pdf/10.1103/PhysRevLett.114.171103&gt;`_.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    E : :class:`~astropy.units.Quantity` or array-like</span>
<span class="sd">        Energy of Galactic cosmic rays. (GeV)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">e2R</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

    <span class="n">term</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="mi">336</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GV</span><span class="p">))</span><span class="o">**</span><span class="mf">5.542</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mf">0.4544</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="mi">45</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GV</span><span class="p">))</span><span class="o">**-</span><span class="mf">2.849</span> <span class="o">*</span> <span class="n">term</span><span class="o">**</span><span class="mf">0.024</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s2">&quot;m-2 sr-1 s-1 GV-1&quot;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">phi</span>

    <span class="c1"># rigidity -&gt; energy (for a proton here)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">si</span>

    <span class="c1"># Return</span>
    <span class="k">return</span> <span class="n">n</span></div>


<div class="viewcode-block" id="compute_fgal_dampe">
<a class="viewcode-back" href="../../subpages/modules.html#craic.injection.compute_fgal_dampe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_fgal_dampe</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E_tran</span><span class="o">=</span><span class="mf">6.3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns differential proton density of galactic CRs (:math:`\mathrm{GeV}^{-1}\,\mathrm{cm}^{-3}`) measured by </span>
<span class="sd">    `DAMPE Collab (2019), SciAdv aax3793 &lt;https://www.science.org/doi/10.1126/sciadv.aax3793&gt;`_.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    E : :class:`~astropy.units.Quantity` or array-like</span>
<span class="sd">        Energy values of Galactic cosmic rays (GeV).</span>
<span class="sd">    E_tran : :class:`~astropy.units.Quantity`</span>
<span class="sd">        Energy at which the low-energy and high-energy Smooth Broken Power-Law (SBPL) fits transition. (TeV)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">DAMPE_SBPL_low</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Smooth Broken Power Law fit for 100 GeV - 6.3 TeV. Returns differential CR density (GeV^-1 cm^-3).</span>
<span class="sd">        </span>
<span class="sd">        Parameter:</span>
<span class="sd">        ----------</span>
<span class="sd">        E: :class:`~astropy.units.Quantity`</span>
<span class="sd">            Energy values of Galactic cosmic rays (GeV)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="n">E_0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
        <span class="n">E_b</span> <span class="o">=</span> <span class="mf">0.48</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="mf">7.58e-5</span> <span class="o">*</span> <span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">E_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.772</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">E_b</span><span class="p">)</span><span class="o">**</span><span class="mf">5.0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.173</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">)</span>
        <span class="n">density</span> <span class="o">=</span> <span class="p">(</span><span class="n">flux</span> <span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">sr</span><span class="o">/</span><span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV^-1*cm^-3&#39;</span><span class="p">)</span> 
        <span class="k">return</span> <span class="n">density</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">DAMPE_SBPL_high</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Smooth Broken Power Law fit for 1 TeV - 100 TeV. Returns differential CR density (GeV^-1 cm^-3)</span>
<span class="sd">        </span>
<span class="sd">        Parameter:</span>
<span class="sd">        ----------</span>
<span class="sd">        E: :class:`~astropy.units.Quantity`</span>
<span class="sd">            Energy values of Galactic cosmic rays (GeV)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E_0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
        <span class="n">E_b</span> <span class="o">=</span> <span class="mf">13.6</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="mf">8.68e-5</span> <span class="o">*</span> <span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">E_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">E_b</span><span class="p">)</span><span class="o">**</span><span class="mf">5.0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">)</span>
        <span class="n">density</span> <span class="o">=</span> <span class="p">(</span><span class="n">flux</span> <span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">sr</span><span class="o">/</span><span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV^-1*cm^-3&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">density</span>
    
    
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV&#39;</span><span class="p">)</span> <span class="c1"># Confirm units of E</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="o">**-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Low-energy SBPL fit (100 GeV - 6.3 TeV)</span>
    <span class="n">low_mask</span> <span class="o">=</span> <span class="n">E</span> <span class="o">&lt;=</span> <span class="n">E_tran</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">low_mask</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">low_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAMPE_SBPL_low</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">low_mask</span><span class="p">])</span>

    <span class="c1">#High-energy SBPL fit (1 - 100 TeV)</span>
    <span class="n">high_mask</span> <span class="o">=</span> <span class="n">E</span> <span class="o">&gt;</span> <span class="n">E_tran</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">high_mask</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">high_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">DAMPE_SBPL_high</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">high_mask</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">result</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, CRAIC Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>